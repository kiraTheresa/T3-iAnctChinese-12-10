# 古文智能标注与解析系统 - 项目需求文档

## 1. 项目概述

### 1.1 项目背景

随着数字化时代的到来，大量古代文献需要被数字化处理和智能分析。传统的人工标注和解析方式效率低下，难以满足大规模古籍研究的需求。本项目旨在开发一套基于AI技术的古文智能标注与解析系统，帮助研究人员和学习者更高效地进行古籍研究。

### 1.2 项目目标

- 提供古籍文本的智能解析功能
- 实现自动实体标注（人物、地名、时间、器物、概念等）
- 支持关系标注和可视化
- 提供项目管理和文档管理功能
- 支持多用户协作

### 1.3 项目范围

本项目包括前端应用、后端服务和AI模型集成三个主要部分：

- **前端应用**：提供用户界面，包括项目管理、文档管理、文本编辑、标注和可视化功能
- **后端服务**：提供用户管理、项目管理、文档管理、标注管理和数据导出功能
- **AI服务**：提供文本分析、问答和自动标注功能

## 2. 功能需求

### 2.1 用户管理

| 功能模块 | 需求描述 |
|---------|---------|
| 用户注册 | 支持用户注册新账号，包括用户名、邮箱和密码验证 |
| 用户登录 | 支持用户登录系统，使用JWT进行身份验证 |
| 个人信息管理 | 支持用户修改个人信息，包括用户名、邮箱和密码 |
| 设置管理 | 支持用户设置系统偏好 |

### 2.2 项目管理

| 功能模块 | 需求描述 |
|---------|---------|
| 项目列表 | 展示用户创建的所有项目 |
| 项目创建 | 支持用户创建新项目，包括项目名称和描述 |
| 项目详情 | 展示项目的详细信息 |
| 项目更新 | 支持用户修改项目信息 |
| 项目删除 | 支持用户删除项目 |

### 2.3 文档管理

| 功能模块 | 需求描述 |
|---------|---------|
| 文档列表 | 展示项目下的所有文档 |
| 文档创建 | 支持用户创建新文档，包括文档名称、描述、内容和作者信息 |
| 文档详情 | 展示文档的详细信息 |
| 文档更新 | 支持用户修改文档信息 |
| 文档删除 | 支持用户删除文档 |
| 文档搜索 | 支持根据关键词搜索文档 |
| 文档导出 | 支持导出文档内容和标注数据 |

### 2.4 文本编辑与标注

| 功能模块 | 需求描述 |
|---------|---------|
| 文本编辑器 | 提供古文文本编辑功能 |
| 实体标注 | 支持手动标注实体，包括人物、地名、时间、器物、概念等 |
| 自动实体标注 | 支持AI自动标注实体 |
| 关系标注 | 支持标注实体之间的关系 |
| 标注管理 | 支持查看、修改和删除标注 |

### 2.5 AI智能分析

| 功能模块 | 需求描述 |
|---------|---------|
| 文本分析 | 支持对古文文本进行智能分析，包括段落划分、句子解析等 |
| 问答功能 | 支持用户针对古文文本提出问题，系统自动回答 |
| 自动标注 | 支持自动标注文本中的实体 |

### 2.6 数据可视化

| 功能模块 | 需求描述 |
|---------|---------|
| 数据总览 | 展示文档的基本统计信息，如总字符数、标注数量等 |
| 实体分布 | 可视化展示不同类型实体的分布情况 |
| 人物关系图 | 可视化展示人物之间的关系 |
| 时间轴 | 可视化展示时间序列信息 |
| 地点地图 | 可视化展示地名在地图上的分布 |

## 3. 非功能需求

### 3.1 性能需求

- 系统响应时间：页面加载时间不超过2秒，API响应时间不超过500毫秒
- 并发处理：支持至少100个并发用户
- 数据处理：支持处理至少100,000字的古文文本

### 3.2 安全性需求

- 用户认证：使用JWT进行身份验证
- 数据加密：敏感数据在传输和存储过程中进行加密
- 权限管理：不同用户只能访问自己的项目和文档
- 防止SQL注入和XSS攻击

### 3.3 可用性需求

- 系统可用性：达到99.5%以上
- 用户界面：友好、直观，符合用户习惯
- 错误处理：提供清晰的错误提示信息

### 3.4 可扩展性需求

- 支持新增实体类型和关系类型
- 支持集成新的AI模型
- 支持扩展新的可视化组件

## 4. 技术需求

### 4.1 前端技术

- React 18 + Vite
- Tailwind CSS
- JavaScript/TypeScript

### 4.2 后端技术

- Node.js + Express
- Python Flask
- MySQL 8.0+

### 4.3 AI模型

- DeepSeek API
- 荀子古汉语大模型（基于魔搭平台的Xunzillm4cc/Xunzi-Qwen2-1.5B）

### 4.4 开发环境

- Node.js 16+
- Python 3.8+
- MySQL 8.0+

## 5. 数据需求

### 5.1 数据模型

- **用户**：id, username, email, password, created_at, updated_at, settings
- **项目**：id, user_id, name, description, created_at, updated_at
- **文档**：id, user_id, project_id, name, description, content, author, created_at, updated_at
- **标注**：id, document_id, type, start, end, label, text, created_at, updated_at
- **关系标注**：id, document_id, source_id, target_id, relation_type, created_at, updated_at
- **地名坐标缓存**：id, name, lng, lat, matched_name, confidence, created_at, updated_at

### 5.2 数据存储

- 使用MySQL数据库存储用户、项目、文档和标注数据
- 支持数据导出为CSV和TXT格式

## 6. 接口需求

### 6.1 用户管理接口

- 登录接口：`POST /api/login`
- 注册接口：`POST /api/register`
- 更新用户接口：`PATCH /api/users/:userId`
- 获取用户列表接口：`GET /api/users`
- 获取用户详情接口：`GET /api/users/:userId`
- 更新设置接口：`PUT /api/users/:userId/settings`
- 修改密码接口：`POST /api/users/:userId/change-password`

### 6.2 项目管理接口

- 获取项目列表接口：`GET /api/projects`
- 获取项目详情接口：`GET /api/projects/:projectId`
- 创建项目接口：`POST /api/projects`
- 更新项目接口：`PUT /api/projects/:projectId`
- 删除项目接口：`DELETE /api/projects/:projectId`

### 6.3 文档管理接口

- 获取文档列表接口：`GET /api/documents`
- 获取文档详情接口：`GET /api/documents/:documentId`
- 创建文档接口：`POST /api/documents`
- 更新文档接口：`PUT /api/documents/:documentId`
- 删除文档接口：`DELETE /api/documents/:documentId`
- 搜索文档接口：`GET /api/documents/search`
- 导出文档接口：`POST /api/export-documents`

### 6.4 标注管理接口

- 获取标注列表接口：`GET /api/documents/:documentId/annotations`
- 添加实体标注接口：`POST /api/documents/:documentId/annotations/entity`
- 批量添加实体标注接口：`POST /api/documents/:documentId/annotations/entity/bulk`
- 删除实体标注接口：`DELETE /api/documents/:documentId/annotations/entity/:annotationId`
- 搜索实体标注接口：`GET /api/annotations/search`
- 统计实体标注数量接口：`GET /api/documents/:documentId/annotations/count`

### 6.5 AI服务接口

- 文本分析接口：`POST /ai/api/analyze`
- 问答接口：`POST /ai/api/qa`
- 自动标注接口：`POST /ai/api/auto-annotate`

### 6.6 可视化接口

- 获取可视化总览统计接口：`GET /api/visualization/overview`
- 获取地点可视化数据接口：`GET /api/visualization/locations`
- 获取人物关系图数据接口：`GET /api/visualization/relationships`
- 获取时间轴数据接口：`GET /api/visualization/timeline`

### 6.7 地名坐标缓存接口

- 查询地名坐标缓存接口：`GET /api/visualization/locations/cache`
- 更新地名坐标缓存接口：`POST /api/visualization/locations/cache`

## 7. 验收标准

### 7.1 功能验收

- 所有功能模块按照需求文档实现
- 系统能够正常运行，没有明显的功能缺陷
- 用户能够顺利完成注册、登录、创建项目、创建文档、标注和可视化等操作

### 7.2 性能验收

- 页面加载时间不超过2秒
- API响应时间不超过500毫秒
- 系统能够处理100个并发用户
- 系统能够处理100,000字的古文文本

### 7.3 安全性验收

- 用户认证和授权机制正常工作
- 敏感数据在传输和存储过程中进行了加密
- 系统能够防止SQL注入和XSS攻击

### 7.4 可用性验收

- 系统可用性达到99.5%以上
- 用户界面友好、直观，符合用户习惯
- 系统提供清晰的错误提示信息

## 8. 项目进度计划

| 阶段 | 时间 | 任务 |
|------|------|------|
| 需求分析与设计 | 1周 | 完成需求分析和系统设计 |
| 前端开发 | 3周 | 完成前端应用开发 |
| 后端开发 | 3周 | 完成后端服务开发 |
| AI服务集成 | 2周 | 完成AI模型集成和API开发 |
| 测试与优化 | 2周 | 完成系统测试和性能优化 |
| 部署与上线 | 1周 | 完成系统部署和上线 |

## 9. 风险评估

| 风险因素 | 风险描述 | 应对措施 |
|---------|---------|---------|
| AI模型精度 | AI自动标注的精度可能不满足要求 | 提供手动修正功能，持续优化AI模型 |
| 数据安全 | 用户数据可能面临泄露风险 | 加强数据加密和访问控制，定期进行安全审计 |
| 系统性能 | 处理大规模文本时可能出现性能问题 | 优化算法和数据库查询，使用缓存机制 |
| 技术集成 | 不同技术栈之间的集成可能存在问题 | 提前进行技术验证，确保各组件能够正常协同工作 |

## 10. 附录

### 10.1 术语定义

- **实体**：文本中具有特定意义的词或短语，如人物、地名、时间等
- **标注**：对文本中的实体进行标记和分类的过程
- **关系标注**：对实体之间的关系进行标记和分类的过程
- **JWT**：JSON Web Token，用于身份验证的令牌
- **ERNIE X1**：百度开发的大语言模型，用于文本分析和生成

### 10.2 参考文档

- React官方文档：https://react.dev/
- Express官方文档：https://expressjs.com/
- MySQL官方文档：https://dev.mysql.com/doc/
- 百度千帆API文档：https://cloud.baidu.com/doc/WENXINWORKSHOP/s/klqx77nzs